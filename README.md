# Ubuntu ネットワークサービス (ルーター/スイッチ/DHCP)

このプロジェクトは、Ubuntuマシンを簡易的なネットワークアプライアンス（ルーター、スイッチ、DHCPサーバー）として動作させるためのPythonプログラムです。

## 機能

*   **スイッチング**: 複数のネットワークインターフェース（例: `eth1`, `eth2`）をブリッジ接続し、L2スイッチとして動作させます。
*   **ルーティング**: IPフォワーディングを有効化し、接続されたデバイスのゲートウェイとして機能します。
*   **DHCPサーバー**: 接続されたクライアントに対して自動的にIPアドレスを割り当てます。

## 必要要件

*   Ubuntu 20.04 以降 (または Netlink をサポートするLinuxディストリビューション)
*   Python 3.6 以降
*   管理者権限 (root) - ネットワーク設定およびポート67の使用に必要です

## インストール

1.  リポジトリをクローンまたはディレクトリをコピーします。
2.  依存ライブラリをインストールします。

```bash
sudo apt update
sudo apt install python3-pip
pip3 install -r requirements.txt
```

## 設定

`config.json` ファイルを作成して設定をカスタマイズできます（指定しない場合はデフォルト値が使用されます）。

**config.json の例:**

```json
{
    "bridge_name": "br0",
    "interfaces": ["eth1", "eth2"],
    "bridge_ip": "192.168.10.1/24",
    "dhcp": {
        "subnet": "192.168.10.0/24",
        "range_start": "192.168.10.100",
        "range_end": "192.168.10.200",
        "dns": "8.8.8.8"
    }
}
```

*   `bridge_name`: 作成するブリッジの名前
*   `interfaces`: ブリッジに追加する物理インターフェースのリスト
*   `bridge_ip`: ブリッジに割り当てるIPアドレス（CIDR形式）
*   `dhcp`: DHCPサーバーの設定

## 実行方法

管理者権限で実行してください。

```bash
sudo python3 main.py --config config.json
```

停止するには `Ctrl+C` を押してください。

## 動作確認

1.  **ブリッジの確認**: `ip link show br0` でブリッジが作成され、インターフェースが接続されているか確認します。
2.  **IPアドレスの確認**: `ip addr show br0` でIPが設定されているか確認します。
3.  **フォワーディング**: `cat /proc/sys/net/ipv4/ip_forward` が `1` になっていることを確認します。
4.  **クライアント接続**: ブリッジされたポートにPC等を接続し、IPアドレスが自動取得できるか確認します。
